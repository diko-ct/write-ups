# Real_chall

```python 
from gmpy2 import iroot
from Crypto.Util.number import long_to_bytes , getPrime , bytes_to_long
Flag = bytes_to_long(b'flagflagfalg')

e = 0x10001

n = 21834392376036708811228147577736892946221656878362989506541202607899086080496115476373305675256978315376138633766659899398733321675891283593097366368545236158428844392069577569821642902360689738630484552337772743634427988041805896179177903785504086527601131289233627385348872054076863619038294956190951338101627445902532691518624915081971627771681764329595799268000414035053506341321664481623459731701795970511378258455370525920613583052102124748854047634164201228185675685947231539737069464308570132579603082540473473618888107118651757906470284392087247216177100858859184261228161265047487421986966068525231252986843



print(n ,e ) 
print(pow(Flag,e,n))
#O1 = (2*p + 3*q)**W1 mod N
#O2 = (5*p + 7*q)**W2 mod N
```
```
e = 0x10001
n = 21834392376036708811228147577736892946221656878362989506541202607899086080496115476373305675256978315376138633766659899398733321675891283593097366368545236158428844392069577569821642902360689738630484552337772743634427988041805896179177903785504086527601131289233627385348872054076863619038294956190951338101627445902532691518624915081971627771681764329595799268000414035053506341321664481623459731701795970511378258455370525920613583052102124748854047634164201228185675685947231539737069464308570132579603082540473473618888107118651757906470284392087247216177100858859184261228161265047487421986966068525231252986843

c = 10364817481305841852838265782213421462177690884797179629687314083979746708364509589994158702542878112411550154316957897558285649671756165475514664560272645694662387237759625737073688445897386615329475194716406278295302608391413166188120561355768515828879253896032313600438794619596651155813341391812609749369098877642423190845153418501575743321018960316296243908317234197337631271526241563992291238713225509493145230481879821835091880214763957476741783255341719724395797722754859240457351698546936297540698695759529408078660609118357906941604040434268025256951710372273065698193397894544724012796563817669808505792839



W1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137
W2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697

O1= 23596427199427125848139415739675825005767265031248259947873054595640982222262329068481522339341230410801685965038676596865016353708941504185692991255815710910617622711351112678443830996074023856998106304660487859720511973736646163378428187430705987667356237718100066329096110897415674415024744953849789323402842959411798570704490934662183367388937884814389768612981791015720117614637268214933047976204836869295382610227789271915783860584938314365460533256559805151025873143869845208055535851829983325532998594601546900805806534106443577486210763398860180416661088310380557599648717639274152305930513623391768549538332

O2 = 8986751756259061502720857819433594818652784156212936478535985692485369109728891115004561589872001932989429945909701453904190050879970307234112338056171143115569229421010709777171376950510484439657082751955844771607568887182496429486488504910965241004249422797320254810974069541901218646030076923806107061197708790791259817087364770332272507232404218514225274882829155830673798725528654340839675148249440665360463072578142424661797848162684312787277528404509286430110311769571565751552665568744042886566346585079158687228005473995200315715818382239246562206400008477161125939741498769929983632328934739758208091082375
```
read about binomial theorem :

(2*p + 3*q) = (2*p )^e1 + 2p^e1-1 * 3q+....+2p*(3q)^e1-1 + (3q)^e1)mod n
O1= (2p)^W1 + (3q)^W1 mod(n) ^ W2 
O2= (5p)^W2 + (7q)^W2 mod(n) ^ W1 

now i will try to delete one of the variables 

O1^W2 = (2p)^W1W2 + (3q)^W1W2 mod(n) * 7^W1W2
O2^W1 = (5p)^W2W1 + (7q)^W2W1 mod(n) * 3^W1W2
try to deleter q 

O1^W2 * 7^W1W2 = (14p)^W1W2 + (21q)^W1W2 mod(n) 

O2^W1 * 3^W1W2 = (15p)^W1W2 + (21q)^W1W2 mod(n)
subtract the equations from each other 

you will have 

O1^W2 * 7^W1W2 - O2^W1 * 3^W1W2 =  -p^W1W2 

p^W1W2 = O2^W1 * 3^W1W2 - O1^W2 * 7^W1W2
but 
how you will get p from this huge number p^W1W2
N = p * q 
then 
gcd(N , p^W1W@) = p 
q= N / p 
finally 
and now i can solve it easily 

```python 
from math import gcd 
from Crypto.Util.number import long_to_bytes , getPrime , bytes_to_long
'''

N = 21834392376036708811228147577736892946221656878362989506541202607899086080496115476373305675256978315376138633766659899398733321675891283593097366368545236158428844392069577569821642902360689738630484552337772743634427988041805896179177903785504086527601131289233627385348872054076863619038294956190951338101627445902532691518624915081971627771681764329595799268000414035053506341321664481623459731701795970511378258455370525920613583052102124748854047634164201228185675685947231539737069464308570132579603082540473473618888107118651757906470284392087247216177100858859184261228161265047487421986966068525231252986843

e  = 0x10001

c = 10364817481305841852838265782213421462177690884797179629687314083979746708364509589994158702542878112411550154316957897558285649671756165475514664560272645694662387237759625737073688445897386615329475194716406278295302608391413166188120561355768515828879253896032313600438794619596651155813341391812609749369098877642423190845153418501575743321018960316296243908317234197337631271526241563992291238713225509493145230481879821835091880214763957476741783255341719724395797722754859240457351698546936297540698695759529408078660609118357906941604040434268025256951710372273065698193397894544724012796563817669808505792839

#c1 = (2*p + 3*q)**e1 mod N
#c2 = (5*p + 7*q)**e2 mod N


e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137
e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697

c1= 23596427199427125848139415739675825005767265031248259947873054595640982222262329068481522339341230410801685965038676596865016353708941504185692991255815710910617622711351112678443830996074023856998106304660487859720511973736646163378428187430705987667356237718100066329096110897415674415024744953849789323402842959411798570704490934662183367388937884814389768612981791015720117614637268214933047976204836869295382610227789271915783860584938314365460533256559805151025873143869845208055535851829983325532998594601546900805806534106443577486210763398860180416661088310380557599648717639274152305930513623391768549538332

c2 = 8986751756259061502720857819433594818652784156212936478535985692485369109728891115004561589872001932989429945909701453904190050879970307234112338056171143115569229421010709777171376950510484439657082751955844771607568887182496429486488504910965241004249422797320254810974069541901218646030076923806107061197708790791259817087364770332272507232404218514225274882829155830673798725528654340839675148249440665360463072578142424661797848162684312787277528404509286430110311769571565751552665568744042886566346585079158687228005473995200315715818382239246562206400008477161125939741498769929983632328934739758208091082375


pe1e2 = pow(7,e1*e2,N) * pow(c1,e2,N) - pow(3,e1*e2,N) * pow(c2,e1,N)
print(gcd(pe1e2,N))
p = gcd(pe1e2 , N )
q = N //p

phi = (p-1)*(q-1)
d = pow(e,-1 , phi )
print(long_to_bytes(pow(c,d,N)))
```

flag = yuctf{N0w_1_c4n_say_th4t_y0u_are_th3_b3st_EVE}
